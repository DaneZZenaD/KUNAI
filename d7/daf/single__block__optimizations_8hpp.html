<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KUNAI Static Analyzer: src/include/KUNAI/mjolnIR/Analysis/single_block_optimizations.hpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">KUNAI Static Analyzer
   </div>
   <div id="projectbrief">KUNAI is a static analysis tool for different binary file formats and architectures which focuses on the analysis at an IR high level.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_b0856f6b0d80ccb263b2f415c91f9e17.html">include</a></li><li class="navelem"><a class="el" href="../../dir_f6632af7ef3002e7a376ef515b96d02b.html">KUNAI</a></li><li class="navelem"><a class="el" href="../../dir_6e2e27915c755b41700e7afd73baadc2.html">mjolnIR</a></li><li class="navelem"><a class="el" href="../../dir_2791cab60a4af01a85ea65f2f5e2ceae.html">Analysis</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">single_block_optimizations.hpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>There are optimizations that can be applied to whole blocks, these will return a modified block or the same as previous one if no optimization is applied.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;memory&gt;</code><br />
<code>#include &lt;optional&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d75/ir__graph_8hpp_source.html">KUNAI/mjolnIR/ir_graph.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d2a/ir__grammar_8hpp_source.html">KUNAI/mjolnIR/ir_grammar.hpp</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for single_block_optimizations.hpp:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/dd8/single__block__optimizations_8hpp__incl.png" border="0" usemap="#asrc_2include_2KUNAI_2mjolnIR_2Analysis_2single__block__optimizations_8hpp" alt=""/></div>
<map name="asrc_2include_2KUNAI_2mjolnIR_2Analysis_2single__block__optimizations_8hpp" id="asrc_2include_2KUNAI_2mjolnIR_2Analysis_2single__block__optimizations_8hpp">
<area shape="rect" title="There are optimizations that can be applied to whole blocks, these will return a modified block or th..." alt="" coords="581,5,759,60"/>
<area shape="rect" title=" " alt="" coords="5,262,73,287"/>
<area shape="rect" title=" " alt="" coords="807,262,874,287"/>
<area shape="rect" title=" " alt="" coords="948,108,1003,133"/>
<area shape="rect" href="../../d0/d75/ir__graph_8hpp.html" title="DiGraph class from miasm implemented in C++ using the classes from MjolnIR, some of basic graph analy..." alt="" coords="737,108,923,133"/>
<area shape="rect" href="../../d9/d2a/ir__grammar_8hpp.html" title="Header file which includes all the grammar of the IR, this will be used as header file by all the int..." alt="" coords="426,181,631,207"/>
<area shape="rect" title=" " alt="" coords="898,262,970,287"/>
<area shape="rect" title=" " alt="" coords="758,181,798,207"/>
<area shape="rect" title=" " alt="" coords="822,181,897,207"/>
<area shape="rect" title=" " alt="" coords="248,343,295,368"/>
<area shape="rect" title=" " alt="" coords="972,181,1027,207"/>
<area shape="rect" href="../../df/d93/utils_8hpp_source.html" title=" " alt="" coords="1051,181,1198,207"/>
<area shape="rect" title=" " alt="" coords="1309,262,1421,287"/>
<area shape="rect" title=" " alt="" coords="994,255,1125,295"/>
<area shape="rect" title=" " alt="" coords="1149,255,1284,295"/>
<area shape="rect" title=" " alt="" coords="314,262,383,287"/>
<area shape="rect" title=" " alt="" coords="407,262,474,287"/>
<area shape="rect" title=" " alt="" coords="498,262,557,287"/>
<area shape="rect" title=" " alt="" coords="580,262,619,287"/>
<area shape="rect" title=" " alt="" coords="111,343,221,368"/>
<area shape="rect" href="../../d5/db7/ir__x86_8hpp.html" title="Values specific for x86 and x86&#45;64 for the registers this will be enums for the registers,..." alt="" coords="149,255,290,295"/>
<area shape="rect" href="../../d3/d09/ir__dalvik_8hpp.html" title="All the data values for the dalvik virtual machine." alt="" coords="642,255,783,295"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d1c/single__block__optimizations_8hpp__dep__incl.png" border="0" usemap="#asrc_2include_2KUNAI_2mjolnIR_2Analysis_2single__block__optimizations_8hppdep" alt=""/></div>
<map name="asrc_2include_2KUNAI_2mjolnIR_2Analysis_2single__block__optimizations_8hppdep" id="asrc_2include_2KUNAI_2mjolnIR_2Analysis_2single__block__optimizations_8hppdep">
<area shape="rect" title="There are optimizations that can be applied to whole blocks, these will return a modified block or th..." alt="" coords="5,5,184,60"/>
<area shape="rect" href="../../d8/d39/optimizer_8hpp.html" title="Class for applying optimization passes to IR, working in IR we will be able to create more generic op..." alt="" coords="5,108,184,148"/>
<area shape="rect" href="../../d5/db8/lifter__android_8hpp.html" title="Class for lifting the code from the Android methods/classes to mjolnIR, different analysis can be app..." alt="" coords="5,196,184,236"/>
</map>
</div>
</div>
<p><a href="../../d7/daf/single__block__optimizations_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a50f42e5bc61d779e55b5e05012088af2"><td class="memItemLeft" align="right" valign="top">std::optional&lt; irblock_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/daf/single__block__optimizations_8hpp.html#a50f42e5bc61d779e55b5e05012088af2">KUNAI::MJOLNIR::nop_removal</a> (irblock_t &amp;block, irgraph_t &amp;graph)</td></tr>
<tr class="memdesc:a50f42e5bc61d779e55b5e05012088af2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the NOP instructions from a block then return the block without any of those NOP instructions.  <a href="../../d7/daf/single__block__optimizations_8hpp.html#a50f42e5bc61d779e55b5e05012088af2">More...</a><br /></td></tr>
<tr class="separator:a50f42e5bc61d779e55b5e05012088af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9119833a38d1c44b9652c3d6214555e4"><td class="memItemLeft" align="right" valign="top">std::optional&lt; irblock_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/daf/single__block__optimizations_8hpp.html#a9119833a38d1c44b9652c3d6214555e4">KUNAI::MJOLNIR::expression_simplifier</a> (irblock_t &amp;block, irgraph_t &amp;graph)</td></tr>
<tr class="memdesc:a9119833a38d1c44b9652c3d6214555e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">We can find some obfuscations that rewrite some simple expressions in order to make them more difficult to follow, we can go block by block discovering them, and reducing to simplified expressions.  <a href="../../d7/daf/single__block__optimizations_8hpp.html#a9119833a38d1c44b9652c3d6214555e4">More...</a><br /></td></tr>
<tr class="separator:a9119833a38d1c44b9652c3d6214555e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf406542674b0db1264a297ff2a1ef19"><td class="memItemLeft" align="right" valign="top">std::optional&lt; irblock_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/daf/single__block__optimizations_8hpp.html#abf406542674b0db1264a297ff2a1ef19">KUNAI::MJOLNIR::instruction_combining</a> (irblock_t &amp;block, irgraph_t &amp;graph)</td></tr>
<tr class="memdesc:abf406542674b0db1264a297ff2a1ef19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Some complex expressions can be combined in something simpler, that make the expression simpler to understand.  <a href="../../d7/daf/single__block__optimizations_8hpp.html#abf406542674b0db1264a297ff2a1ef19">More...</a><br /></td></tr>
<tr class="separator:abf406542674b0db1264a297ff2a1ef19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >There are optimizations that can be applied to whole blocks, these will return a modified block or the same as previous one if no optimization is applied. </p>
<dl class="section author"><dt>Author</dt><dd>Farenain </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9119833a38d1c44b9652c3d6214555e4" name="a9119833a38d1c44b9652c3d6214555e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9119833a38d1c44b9652c3d6214555e4">&#9670;&#160;</a></span>expression_simplifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; irblock_t &gt; KUNAI::MJOLNIR::expression_simplifier </td>
          <td>(</td>
          <td class="paramtype">irblock_t &amp;&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">irgraph_t &amp;&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We can find some obfuscations that rewrite some simple expressions in order to make them more difficult to follow, we can go block by block discovering them, and reducing to simplified expressions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block</td><td></td></tr>
    <tr><td class="paramname">grap</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::optional&lt;irblock_t&gt; </dd></dl>

</div>
</div>
<a id="abf406542674b0db1264a297ff2a1ef19" name="abf406542674b0db1264a297ff2a1ef19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf406542674b0db1264a297ff2a1ef19">&#9670;&#160;</a></span>instruction_combining()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; irblock_t &gt; KUNAI::MJOLNIR::instruction_combining </td>
          <td>(</td>
          <td class="paramtype">irblock_t &amp;&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">irgraph_t &amp;&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Some complex expressions can be combined in something simpler, that make the expression simpler to understand. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block</td><td></td></tr>
    <tr><td class="paramname">graph</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::optional&lt;irblock_t&gt; </dd></dl>

</div>
</div>
<a id="a50f42e5bc61d779e55b5e05012088af2" name="a50f42e5bc61d779e55b5e05012088af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50f42e5bc61d779e55b5e05012088af2">&#9670;&#160;</a></span>nop_removal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; irblock_t &gt; KUNAI::MJOLNIR::nop_removal </td>
          <td>(</td>
          <td class="paramtype">irblock_t &amp;&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">irgraph_t &amp;&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the NOP instructions from a block then return the block without any of those NOP instructions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">block</td><td></td></tr>
    <tr><td class="paramname">graph</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>std::optional&lt;irblock_t&gt; </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
